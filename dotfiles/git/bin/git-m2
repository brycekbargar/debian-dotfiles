#!/bin/bash
#
# git m2 (git "merge to")
#
# Merges the current branch to the target branch in $1
# Optionally deletes the current branch if -d is specified
#

if ! [ "$1" ]; then
  echo 'error: You didnt specify a target branch'
  return 1
fi

toMerge=`git branch | sed -n '/\* /s///p'`
git checkout $1
git merge --no-ff $toMerge

if [ "$2" = '-d' ]; then
  git branch -d $toMerge
  git push --delete origin $toMerge
fi