#!/bin/zsh
#
# Sees if lpass is has login information
# Logs in if it doesn't
# Syncs before issuing command
#


unset -f lpass > /dev/null
BIN_LPASS=$(which lpass)
lpass () {
  local bin_lpass=/usr/local/bin/lpass
  if [ ! -e "$HOME/.lpass/session_privatekey" ]; then
    $BIN_LPASS login <username>
  fi

  $BIN_LPASS sync
  $BIN_LPASS $@
}
export -f lpass > /dev/null