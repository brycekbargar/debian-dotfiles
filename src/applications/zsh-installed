#!/bin/bash
#
# Installs zsh and sets it as the default shell
#
requires log-writer
requires homebrew
homebrew_init

if [[ "$SHELL" =~ 'zsh' ]]; then
    log_trace 'Already have zsh'

    return 0;
elif ! brew install zsh; then
    log_error $'Couldn\'t install zsh'

    exit 1
fi

if [[ ! "$SHELL" =~ 'zsh' ]]; then

  zsh_loc=/usr/local/bin/zsh

  if ! grep "$zsh_loc" /etc/shells; then
    sudo sh -c "echo '$zsh_loc' >> /etc/shells"
  fi

  chsh -s "$zsh_loc"
fi

log_message 'You have zsh'
