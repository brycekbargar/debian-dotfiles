#!/bin/bash

export HOMEBREW_GITHUB_API_TOKEN="$(lpass show --password ApiKeys/HomebrewToken)"

brew cask install caffeine
brew cask install dropbox
brew cask install flux
brew cask install google-chrome
brew cask install hammerspoon
mkdir -p "$HOME/.hammerspoon"
ln -sf "$DOTFILES/hammerspoon/init.lua" "$HOME/.hammerspoon/init.lua"
brew cask install iterm2
brew cask install itsycal
brew cask install screenhero
brew cask install selfcontrol
brew cask install slack
brew tap caskroom/drivers
brew cask install sonos
brew cask install tidal
brew cask install vagrant
brew cask install virtualbox
mkdir -p "$HOME/Boxes"
brew cask install ynab

log_message 'Installing Karabiner Fork with multi-mappings'

pushd "$LIB"
  curl -LOk `curl https://api.github.com/repos/wwwjfy/karabiner-elements/releases/latest | awk '/browser_download_url/ { print $2 }' | sed 's/"//g'`

  sudo hdiutil attach ./*.dmg
  sudo installer -package /Volumes/Karabiner-Elements**/*.pkg -target /
  sudo hdiutil detach /Volumes/Karabiner-Elements**

  rm ./*.dmg
popd

mkdir -p "$HOME/.config/karabiner"
ln -sf "$DOTFILES/karabiner/karabiner.json" "$HOME/.config/karabiner/karabiner.json"

log_message 'Installed Karabiner!'
